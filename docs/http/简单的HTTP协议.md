---
sidebarDepth: 2
---
# 简单的HTTP协议

## HTTP协议用于客户端和服务器端之间的通信

请求访问文本或图像等资源的一端称为客户端，而提供资源响应的一端称为服务器端。

在两台计算机之间使用HTTP协议通信时，在一条通信线路上必定有一端时客户端，另一端则是服务器端。

## 通过请求和响应的交换达成通信

HTTP协议规定，请求从客户端发出，最后服务器端响应该请求并返回。

换句话说，肯定是先从客户端开始建立通信的，服务器端在没有接受到请求之前不会发送响应。

客户端发送请求的内容是请求报文，服务器端响应的内容是响应报文

### 请求报文

请求报文是由请求方法、请求URI、协议版本、可选的请求首部字段和内容实体构成。

![](\简单的HTTP协议-01.png)

### 响应报文

响应报文是由协议版本、状态码、用以解释状态码的原因短语、可选的响应首部以及实体主体构成。

![简单的HTTP协议-02](\简单的HTTP协议-02.png)

## HTTP是不保存状态的协议

HTTP是一种不保存状态，即无状态的协议。也就是说，在HTTP这个级别，协议对于发送过的请求后响应都不做持久化处理。

目的是为了更快地处理大量的事务，确保协议的可伸缩性，而特意设计的如此简单。

HTTP/1.1虽然是无状态协议，但为了实现期望的保持状态功能，于是引入了cookie技术。

## HTTP通过请求URI定位资源

HTTP协议使用URI定位互联网上的资源。正是因为URI的特定功能，在互联网上任意位置的资源都能访问到。

当客户端请求访问资源而发送请求时，URI需要将作为请求报文中的请求URI包含在内。

指定请求URI的方式有很多，如下：

![简单的HTTP协议-03](\简单的HTTP协议-03.png)

## HTTP使用方法下达命令

向请求URI指定的资源发送请求报文时，采用称为方法的命令。

方法的作用在于，可以指定请求的资源按期望产生某种行为。

方法有以下：

![简单的HTTP协议-04](\简单的HTTP协议-04.png)

其中LINK和UNLINK已被HTTP/1.1废弃，不再支持。

## 持久连接节省通信量

HTTP协议的初始版本中，每进行一次HTTP通信就要断开一次TCP连接。

在早期这样是没有问题的，但随着HTTP的普及，一个文档中可能包含大量的图片的情况越来越多，如果在按照以前的方式，就会造成无谓的TCP连接建立和断开，增加通信量的开销。

为了解决这个问题，HTTP/1.1提出了持久连接和管线化。

### 持久连接

持久连接（HTTP keep-alive）的特点是，只要任意一端没有明确提出断开连接，则保持TCP连接状态。

好处：

1. 减少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载。
2. 减少了开销的那部分时间，使HTTP请求和响应能够更早的结束。

在HTTP/1.1中，所有的连接默认都是持久连接。

### 管线化

持久连接使得多少请求以管线化方式发送成为可能。

从前发送请求后需要等待并收到响应后才能发送下一个请求。

管线化技术的出现，可以不用等待响应亦可以之间发送下一个请求。这样就可以同时并行发送多个请求。

可以大大的加快网页的显示时间。

## HTTP使用Cookie的状态管理

HTTP是无状态协议，也就是说，无法根据之前的状态进行本次的请求处理。

对于需要保存用户登录的状态的场景时，这时HTTP的无状态就很尴尬了。

于是，HTTP引入了Cookie技术。

Cookie技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。

Cookie会根据从服务器端发送的响应报文内的一个叫做Set-Cookie的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入Cookie值后发送出去。

服务器端发现客户端发送过去的Cookie后，会去检查究竟是从哪个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前的状态信息。

![简单的HTTP协议-05](\简单的HTTP协议-05.png)

